# `Settings` package
## Usage example

### Project structure:
* `config/config.go`    Config package (wrapper)
* `config/structs.go`   Settings structs declarations (autogenerated)
* `config/defaults.go`  Settings default values (autogenerated)
* `bin/default.jsonc`   Default settings and values

#### `config/config.go` file content:
```go
package config

// Depends: go get -u github.com/modulo-srl/mu-config/json2struct
//go:generate json2struct -declare -warn -struct=configData -pkg=config -out=structs.go ../bin/default.jsonc
//go:generate json2struct -values  -warn -struct=configData -pkg=config -out=defaults.go ../bin/default.jsonc

import (
	"time"
	"github.com/modulo-srl/mu-config/settings"
)

var cfg ConfigData

var configCtrl *settings.Settings

const saveAfter = 5 * time.Second

// GetConfigData returns config data struct.
func GetConfigData(forceReload bool) *ConfigData {
	if forceReload {
		err := configCtrl.LoadSettings()
		if err != nil {
			panic(err)
		}
	}

	return &cfg
}

// SaveConfig can be called frequently (antibounce).
func SaveConfig() {
	configCtrl.SaveSettingsDebounce(saveAfter)
}

// SaveConfigNow saves immediately (no antibounce).
func SaveConfigNow() error {
	return configCtrl.SaveSettings()
}

// LoadConfig loads the settings.
func LoadConfig() error {
	err := configCtrl.LoadSettings()
	if err != nil {
		return err
	}

	return nil
}

// Init initialize settings.
func Init(filename string) error {
	var err error

	cfg = initConfigData()  // fill struct with default data (see config/defaults.go)

	configCtrl, err = settings.New(filename, &cfg, false)
	if err != nil {
		return err
	}

	return nil
}
```
